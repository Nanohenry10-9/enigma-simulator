<!DOCTYPE html>
<html onclick="ee(event)">
	<head>
		<title>The Enigma Machine</title>
		<link rel="icon" type="image/png" href="favicon.png">
		<link rel="stylesheet" href="style.css">
		<script src="processing.js"></script>
	</head>
	<body>
		<h1>The Enigma Machine</h1>
		<canvas data-processing-sources="./enigma/enigma.pde" id="simulator"></canvas>
		<div id="op">
			<input type="text" id="text-in"><br>
			<input type="button" value="Crypt!" id="button" onclick="crypt()"><br>
			<input type="text" id="text-out"><br>
			<input type="button" value="Reset" id="reset" onclick="reset()">
		</div>
		<script>
			var plaintext;
			var ciphertext;
			setInterval(readCipher, 20);
			var pInstance;
			function crypt() {
				verify();
				plaintext = document.getElementById("text-in").value;
				pInstance.setPlaintext(plaintext);
			}
			function reset() {
				verify();
				pInstance.resetCipher();
			}
			function readCipher() {
				verify();
				document.getElementById("text-out").value = pInstance.getCiphertext();
			}
			function verify() {
				if (pInstance == null) {
					var pInstance = Processing.getInstanceById('simulator');
				}
			}
			function ee(e) {
				if (e.x == 0 && e.y == 0) {
					window.location.href = "https://buster.lu";
				}
			}
			function help() {
				alert("Input: keyboard keys A - Z\nChange plugboard: CTRL + [key 1, A - Z] + [key 2, A - Z]\nChange rotors: CTRL + [rotor #, 1 - 3] + [rotor name, 1 - 3]\nReset rotors: CTRL + SPACE\n\n(you may need to first click on the simulator to use it)");
			}
		</script>
	</body>
</html>
